# Deployment Guide - JugaadPress

## Deploy to Render (Free Tier)

### Prerequisites
- GitHub account
- Google Cloud Console project with OAuth credentials

### Step 1: Prepare Google OAuth

1. Go to [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
2. Select your existing OAuth 2.0 Client ID (or create new one)
3. Add authorized redirect URIs:
   ```
   https://your-app-name.onrender.com/oauth2callback
   ```
   (Replace `your-app-name` with your actual Render service name)
4. Make sure these APIs are enabled:
   - Google Drive API
   - Gmail API

### Step 2: Deploy to Render

1. **Sign up/Login to Render**
   - Go to [render.com](https://render.com)
   - Sign up with GitHub

2. **Create New Web Service**
   - Click "New +" → "Web Service"
   - Connect your GitHub repository
   - Select the JugaadPress repository

3. **Configure Service**
   - Render will auto-detect the `render.yaml` file
   - Click "Apply" to use the blueprint settings

4. **Set Environment Variables**
   - Go to your service → "Environment"
   - Add these variables:
     ```
     GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
     GOOGLE_CLIENT_SECRET=your-client-secret
     ```
   - Note: `FLASK_SECRET_KEY` is auto-generated by Render

5. **Deploy**
   - Click "Manual Deploy" → "Deploy latest commit"
   - Wait 3-5 minutes for build to complete

### Step 3: Update Google OAuth Redirect URI

1. Once deployed, note your Render URL: `https://your-app-name.onrender.com`
2. Go back to Google Cloud Console → Credentials
3. Update authorized redirect URIs with the actual URL:
   ```
   https://your-actual-app-name.onrender.com/oauth2callback
   ```

### Step 4: Test

1. Visit `https://your-app-name.onrender.com`
2. Click "Sign in with Google"
3. Grant permissions (Drive + Gmail)
4. Start creating books!

## Important Notes

### Free Tier Limitations
- Service spins down after 15 minutes of inactivity
- First request after spin-down takes ~30 seconds
- 750 hours/month free (enough for one service 24/7)

### OAuth Consent Screen
- If your app is in "Testing" mode in Google Cloud Console:
  - Only test users you add can log in
  - Add users in: Google Cloud Console → OAuth consent screen → Test users
- To make public: Submit for verification (optional)

### Custom Domain (Optional)
- Render free tier allows custom domains
- Add in: Service settings → Custom Domain
- Update Google OAuth redirect URI accordingly

### Monitoring
- Check logs: Render Dashboard → Logs tab
- Auto-deploy on git push to main branch

## Troubleshooting

### "redirect_uri_mismatch" error
- The redirect URI in Google Cloud doesn't match your Render URL
- Make sure to include `/oauth2callback` path
- Check for http vs https

### Service keeps spinning down
- This is normal on free tier
- Consider upgrading to paid tier ($7/month) for always-on

### Build fails
- Check Render logs for specific error
- Ensure `requirements.txt` is up to date
- Check Python version compatibility

## Environment Variables Reference

| Variable | Description | Where to Get |
|----------|-------------|--------------|
| `FLASK_SECRET_KEY` | Flask session encryption | Auto-generated by Render |
| `GOOGLE_CLIENT_ID` | OAuth client ID | Google Cloud Console → Credentials |
| `GOOGLE_CLIENT_SECRET` | OAuth client secret | Google Cloud Console → Credentials |

## Auto-Deployment

Render automatically deploys when you push to `main` branch:
```bash
git add .
git commit -m "your changes"
git push origin main
```

Wait 2-3 minutes for Render to build and deploy.

---

**Need help?** Check [Render docs](https://render.com/docs) or open an issue on GitHub.
